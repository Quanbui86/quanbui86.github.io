<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Login page</title>
	<link type="text/css" rel="stylesheet" href="reset.css">
    <link type="text/css" rel="stylesheet" href="style.css">
	<script src="./login.js" defer></script>
</head>

<body>
	<main>
		<section id="logSection">
			<div class="conntainer">
				<h1>Login Form</h1>
				<div id="noti4">
					<p name="welcome">“Please enter your username and password.”</p>
				</div>
				<div id="noti5">
					<p name="loginSuccess">
						“<strong style="color: green;">Success!</strong>&nbsp;You will be redirected to the Home page shortly...”</p>
					</p>
				</div>
				<form onsubmit="handleLogin()" class="flex-middle">
					<label class="logName" class="login-input">Username</label>
					<input id="logName" type="text" placeholder="Username" name="logName"/>
					<label class="logPass" class="login-input">Password</label>
					<input id="logPass" type="password" placeholder="Password" name="logPass"/>
					<div class="return-and-login">
                        <a type="button" href="register.html">Registration</a>
                        <button type="submit" value="Login">Login</button>
                    </div>
			</form>
			</div>
		</section>
	</main>
    <script>
		function handleLogin() {
            // Ngăn trang không load lại khi submit form
			event.preventDefault();
            //Khai báo biến, function - gán các biến vào các elements, value
            let welcome = document.querySelector("[id='noti4']")
            let loginSuccess = document.querySelector("[id='noti5']")
            let logName = document.querySelector("[name='logName']").value
            let logPass = document.querySelector("[name='logPass']").value
			let logSection = document.getElementById('logSection')
            let auth = false;
            const Redirect = () =>{
                window.location.replace('./index.html')
            }
            // Kiểm tra các biến với giá trị đã lưu trong localStorage
            // Kiểm tra logName có tồn tại trong localStorage không? => logPass có trùng với password ko?
            if(localStorage.getItem(logName)){
                password = JSON.parse(localStorage.getItem(logName)).password
                if(logPass === password) {
                    auth = true;
                } else alert('Wrong password')
            } else alert('Username does not exist.')
            // Các điều kiện thõa mãn thì thông báo và chuyển trang
            if(auth){
                welcome.style.opacity = '0';
                loginSuccess.style.opacity = '1'
                setTimeout(Redirect, 2000)
				logSection.style.opacity = '0'
				logSection.style.scale = '1.5'
				logSection.style.transition = 'opacity 2s linear, scale 2s linear'
            }
		}
	</script>
</body>

</html>